# 01.数据库特性及隔离级别

**四大特性ACID**

- 原子性(Atomicity)：事务是不可分割的最小操作但愿，要么全部成功，要么全部失败
- 一致性(Consistency)：事务完成时，必须使所有数据都保持一致状态
- 隔离性(Isolation)：数据库系统提供的隔离机制，保证事务在不受外部并发操作影响的独立环境下运行
- 持久性(Durability)：事务一旦提交或回滚，它对数据库中的数据的改变就是永久的

**并发事务**

| 问题       | 描述                                                         |
| :--------- | :----------------------------------------------------------- |
| 脏读       | 一个事务读到另一个事务还没提交的数据                         |
| 不可重复读 | 一个事务先后读取同一条记录，但两次读取的数据不同             |
| 幻读       | 一个事务按照条件查询数据时，没有对应的数据行，但是再插入数据时，又发现这行数据已经存在 |

[这三个问题的详细演示地址](bilibili.com/video/BV1Kr4y1i7ru?p=55&vd_source=a831b8ccbd6182318311bce17d1c5f87)

脏读：两个客户端开启了两个事务A，B，A修改了表中的数据，此时事务A还没提交，B此时读取表中的数据，读到了A刚刚修改过但没提交的数据。

不可重读读：两个客户端开启了两个事务A，B，A先读取表中数据，B修改表中数据后，提交事务，A再次读取数据，发现两次读的数据不一样。

幻读：两个客户端开启了两个事务A，B，A先查询一个不在表中的数据message，发现查不到，B此时添加message并提交，此时A再插入message，发现插入不了，显示message已经在表中，但当再次查询表时又查不到message（可重复读），导致A出现了幻觉。

**并发事务隔离级别**：

| 隔离级别              | 脏读 | 不可重复读 | 幻读 |
| :-------------------- | :--- | :--------- | :--- |
| Read uncommitted      | √    | √          | √    |
| Read committed        | ×    | √          | √    |
| Repeatable Read(默认) | ×    | ×          | √    |
| Serializable          | ×    | ×          | ×    |

- mysql默认隔离级别是Repeatable Read，oracle的默认隔离级别是Read committed
- √表示在当前隔离级别下该问题会出现
- Serializable 性能最低；Read uncommitted 性能最高，数据安全性最差

查看事务隔离级别：
`SELECT @@TRANSACTION_ISOLATION;`
设置事务隔离级别：
`SET [ SESSION | GLOBAL ] TRANSACTION ISOLATION LEVEL {READ UNCOMMITTED | READ COMMITTED | REPEATABLE READ | SERIALIZABLE };`
SESSION 是会话级别，表示只针对当前会话有效，GLOBAL 表示对所有会话有效

# 02.mysql和redis的区别

**类型**

- mysql是关系型数据库，主要用于存放持久化数据，将数据存储在硬盘中，读取速度较慢。
- redis是NOSQL，即非关系型数据库，也是缓存数据库，即将数据存储在缓存中，缓存的读取速度快，能够大大的提高运行效率，但是保存时间有限。

**运行机制**

- mysql是持久化存储的关系型数据库，每次请求访问数据库时，都存在着I/O操作，如果反复频繁的访问数据库。第一：会在反复链接数据库上花费大量时间，从而导致运行效率过慢；第二：反复的访问数据库也会导致数据库的负载过高，那么此时缓存的概念就衍生了出来。
- redis数据库就是一款缓存数据库，用于存储使用频繁的数据，这样减少访问数据库的次数，提高运行效率。

**需求**

- mysql和redis因为需求的不同，一般都是配合使用。
- 需要高性能的地方使用Redis，不需要高性能的地方使用MySQL。
